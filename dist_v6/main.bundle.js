(()=>{"use strict";var t,e,n,r,i={88:(t,e,n)=>{n.a(t,(async(t,e)=>{try{var r=n(228),i=n(626),o=n(170),a=n(612),s=n(713),c=n(59),u=n(41),l=n(368),h=n(796),d=n(269);const f=document.getElementById("gravityVal"),p=document.getElementById("frictionVal"),m=document.getElementById("angvelVal"),M=document.getElementById("rolldampVal"),g=document.getElementById("jumpforceVal"),v=document.getElementById("gameover"),x=document.getElementById("timer");let w=!1;const y=document.getElementById("sliders"),b=document.getElementById("pin");b.addEventListener("click",(()=>{w?(b.innerText="Pin ðŸ“Œ",w=!1):(b.innerText="Unpin ðŸ“Œ",w=!0),y.classList.toggle("pinned")}));let B=-parseFloat(document.getElementById("gravity").value)-1,R=.3,P=parseFloat(document.getElementById("friction").value)/30,k=100*parseFloat(document.getElementById("angvel").value),S=parseFloat(document.getElementById("rolldamp").value)/40+.75,T=parseFloat(document.getElementById("jumpforce").value),I=new h.L;await I.loadImage("./objects/2_no_clouds_8k (Medium).jpg",1,1);const A=window.document.getElementById("canvas"),D=new o.A(A);await D.initialize(I,"./objects/skybox/");const E=new i.l(A);async function F(){let t=!1;const e=new a.Z,n=new r.i({name:"Kamera",id:"kameraID",position:[0,7.5,-21],rotation:[16,180,0],cameraType:r.A.perspective,aspectRatio:A.width/A.height,fov:60,near:.1,far:300}),o=new u.i({name:"Lopta",id:"sphereID",position:[0,3,-9],rotation:[0,0,0],radius:1,texture:{atlas:I,indexX:0,indexY:0},velocity:{x:0,y:0,z:0}}),h=new s.I({name:"Kocka",id:"kockaID",position:[0,0,-11],rotation:[0,0,0],lenght:[10,.5,10],color:[.3,.5,.8,1]}),w=new s.I({name:"Kocka",id:"kockaID",position:[0,0,15],rotation:[0,0,0],lenght:[10,.5,10],color:[.3,.5,.8,1]}),y=new s.I({name:"Kocka",id:"kockaID",position:[15,-2,8],rotation:[0,0,0],lenght:[10,.5,15],color:[.3,.5,.8,1]}),b=new s.I({name:"Kocka",id:"kockaID",position:[0,7,27],rotation:[-45,0,0],lenght:[10,.5,20],color:[.3,.5,.8,1]}),F=new s.I({name:"Kocka",id:"kockaID",position:[0,14,41],rotation:[0,0,0],lenght:[20,.5,10],color:[.3,.5,.8,1]}),q=new s.I({name:"Kocka",id:"kockaID",position:[-17,9,41],rotation:[0,0,-20],lenght:[10,.2,10],color:[.3,.5,.8,1]}),z=new s.I({name:"Kocka",id:"kockaID",position:[0,-2,35],rotation:[-15,0,0],lenght:[10,.5,25],color:[.3,.5,.8,1]}),V=new s.I({name:"Kocka",id:"kockaID",position:[0,-10,10],rotation:[-8,0,0],lenght:[2.5,.2,25],color:[.3,.5,.8,1]}),G=new s.I({name:"Kocka",id:"kockaID",position:[-5,-10,0],rotation:[8,0,0],lenght:[2.5,.2,10],color:[.3,.5,.8,1]}),U=new s.I({name:"Kocka",id:"kockaID",position:[-4,-8,-15],rotation:[0,0,0],lenght:[6,2,6],color:[.3,.5,.8,1]}),O=new s.I({name:"Kocka",id:"kockaID",position:[4,-5,-24],rotation:[0,0,0],lenght:[6,2,6],color:[.3,.5,.8,1]}),C=new s.I({name:"Kocka",id:"kockaID",position:[14,-1,-15],rotation:[0,0,0],lenght:[6,1,6],color:[.3,.5,.8,1]}),L=new c.v({name:"Svijetlo",id:"svijetloID",position:[0,0,0],rotation:[.3,-.7,.2]});e.setCamera(n),e.setLight(L),e.addShapes(h,w,y,b,F,q,z,V,G,U,O,C,o),o.attach(n);let Y=1/60,j=0,_=0,X=!1,N=!1,Z=!1,K=12;return new Promise((n=>{let r=a=>{B=-parseFloat(document.getElementById("gravity").value)-1,P=parseFloat(document.getElementById("friction").value)/40,k=100*parseFloat(document.getElementById("angvel").value),S=parseFloat(document.getElementById("rolldamp").value)/40+.75,T=100*parseFloat(document.getElementById("jumpforce").value),f.textContent=B.toString(),p.textContent=P.toFixed(3),m.textContent=k.toString(),M.textContent=S.toFixed(3),g.textContent=T.toString(),K>0&&(j+=Y,x.innerText=`${j.toFixed(2)} s`),0==K&&0==N&&(Z=!0,v.innerHTML="Nice time!<br>"+j.toFixed(2)+" s<br>Press R to reset"),_=a;let c=E.control(o,X,1,k,T,Y,i.f.keyboard);if((c&&!N||c&&Z)&&(t=!0),X=!1,e.shapes.forEach((t=>{if(t instanceof s.I){let e=(0,l.p)(o,t);if(void 0!==e){0!=t.color[0]&&.8!=t.color[1]&&.2!=t.color[2]&&(t.color.set([0,.8,.2]),K-=1);let n=o.getNormal(e.res[0],e.res[1],e.res[2]),r=d.eR.negate(n);r[1]>0&&(X=!0);let i=d.eR.scale(n,100*-o.getRadius()),a=d.eR.cross(i,o.angularVelocity);o.velocity=d.eR.lerp(o.velocity,a,P),o.angularVelocity=d.eR.scale(o.angularVelocity,S);let s=d.eR.scale(r,e.ratio*o.getRadius());o.globalMove(s[0],s[1],s[2]);const c=d.eR.dot(o.velocity,r);let u=R;if(Math.abs(c)<.005&&(u=0),c<0){let t=d.eR.scale(r,(1+u)*c);o.velocity=d.eR.subtract(o.velocity,t)}}}})),o.addForce(0,B*Y,0),o.globalMove(o.velocity[0]*Y,o.velocity[1]*Y,o.velocity[2]*Y),o.globalRotate(-o.angularVelocity[0]*o.getRadius()*100,0,-o.angularVelocity[2]*o.getRadius()*100),o.position[1]<-15&&0==N&&!Z){N=!0;let e=3;const n=setInterval((()=>{if(!(e>0))return clearInterval(n),void(t=!0);v.innerHTML=`Game over<br>Respawning in ${e}`,e-=1}),1e3)}D.render(e),t?n():requestAnimationFrame(r)};requestAnimationFrame(r)}))}async function q(){for(;;)v.innerHTML="",await F()}q(),e()}catch(z){e(z)}}),1)},368:(t,e,n)=>{n.d(e,{p:()=>i});var r=n(269);function i(t,e){const n=r.eR.subtract(t.position,e.position),i=r.pB.transpose(e.getRotationMatrix()),o=r.eR.transformMat4(n,i),a=Math.max(-e.getLength()[0]/2,Math.min(o[0],e.getLength()[0]/2)),s=Math.max(-e.getLength()[1]/2,Math.min(o[1],e.getLength()[1]/2)),c=Math.max(-e.getLength()[2]/2,Math.min(o[2],e.getLength()[2]/2)),u=o[0]-a,l=o[1]-s,h=o[2]-c,d=u*u+l*l+h*h;if(d<=t.getRadius()*t.getRadius()){let n=new Float32Array([a,s,c]),i=r.pB.multiply(e.getPositionMatrix(),e.getRotationMatrix());return n=r.eR.transformMat4(n,i),{res:n,ratio:(t.getRadius()-Math.sqrt(d))/t.getRadius()}}}},626:(t,e,n)=>{var r;n.d(e,{f:()=>r,l:()=>i}),function(t){t[t.mouse=0]="mouse",t[t.keyboard=1]="keyboard"}(r||(r={}));class i{canvas;keysPressed;keyPress;mouseDeltaX;mouseDeltaY;mouseScrollDelta;leftMouseDown;middleMouseDown;rightMouseDown;constructor(t){this.canvas=t,this.keysPressed=new Map,this.keyPress=new Set,this.mouseDeltaX=0,this.mouseDeltaY=0,this.mouseScrollDelta=0,this.leftMouseDown=!1,this.middleMouseDown=!1,this.rightMouseDown=!1,this.listen()}listen=()=>{this.canvas.addEventListener("contextmenu",(t=>t.preventDefault())),window.addEventListener("keydown",(t=>this.keysPressed.set(t.key,!0))),window.addEventListener("keyup",(t=>this.keysPressed.set(t.key,!1))),this.canvas.style.touchAction="pinch-zoom",this.canvas.addEventListener("mousedown",(t=>{switch(t.button){case 0:this.leftMouseDown=!0;break;case 1:this.middleMouseDown=!0;break;case 2:this.rightMouseDown=!0}})),this.canvas.addEventListener("mouseup",(t=>{switch(t.button){case 0:this.leftMouseDown=!1;case 1:this.middleMouseDown=!1;case 2:this.rightMouseDown=!1}})),this.canvas.addEventListener("pointermove",(t=>{(this.leftMouseDown||this.middleMouseDown||this.rightMouseDown)&&(this.mouseDeltaX+=t.movementX,this.mouseDeltaY+=t.movementY)})),this.canvas.addEventListener("wheel",(t=>{this.mouseScrollDelta+=t.deltaY}))};getKeysPressed(){return this.keysPressed}getKeyPress(){return this.keyPress}getMouseMovement=()=>{let t=[this.mouseDeltaX,this.mouseDeltaY,this.mouseScrollDelta];return this.mouseDeltaX=0,this.mouseDeltaY=0,this.mouseScrollDelta=0,t};control(t,e,n,i,o,a,s){let c=!1;if(s==r.keyboard&&this.getKeysPressed().forEach(((n,r)=>{if(n)switch(r){case"a":t.globalRotate(0,100*a,0);break;case"d":t.globalRotate(0,-100*a,0);break;case"w":t.rotateRelative("x",-i*a);break;case"s":t.rotateRelative("x",i*a);break;case"q":t.rotateRelative("z",i*a);break;case"e":t.rotateRelative("z",-i*a);break;case" ":e&&t.addForce(0,o*a,0);break;case"r":c=!0}})),s==r.mouse){let e=this.getMouseMovement();this.leftMouseDown?(t.globalMove(0,e[1]*a*-n,0),t.localMove(e[0]*a*-n,0,0)):this.rightMouseDown?t.globalRotate(e[1]*a*i,e[0]*a*i,0):this.middleMouseDown&&t.globalRotate(0,0,e[0]*a*i),t.localMove(0,0,e[2]*a*-n)}return c}forceControl(t,e,n,r,i){let o=!1;return this.getKeysPressed().forEach(((t,n)=>{if(t)switch(o=!0,n){case"a":case"d":break;case"w":r[0]+=e*i;break;case"s":r[0]-=e*i;break;case"q":r[2]+=e*i;break;case"e":r[2]-=e*i}})),o}}},228:(t,e,n)=>{n.d(e,{A:()=>r,i:()=>a});var r,i=n(269),o=n(788);!function(t){t[t.perspective=0]="perspective"}(r||(r={}));class a extends o.w{type;fov;near;far;aspectRatio;projectionMatrix;constructor(t){super(t),this.aspectRatio=t.aspectRatio,this.type=t.cameraType,this.fov=Math.PI/3,this.near=.1,this.far=100,this.projectionMatrix=i.pB.perspective(this.fov,this.aspectRatio,this.near,this.far)}getData(){let t=i.pB.multiply(this.positionMatrix,this.rotationMatrix),e=i.pB.inverse(t);return{projection:this.projectionMatrix,camera:e}}}},59:(t,e,n)=>{n.d(e,{v:()=>o});var r=n(269),i=n(788);class o extends i.w{constructor(t){super(t)}localRotate=(t,e,n)=>{r.eR.rotateX(this.rotation,r.eR.zero(),180*t/Math.PI,this.rotation),r.eR.rotateY(this.rotation,r.eR.zero(),180*e/Math.PI,this.rotation),r.eR.rotateZ(this.rotation,r.eR.zero(),180*n/Math.PI,this.rotation)};getData(){return this.rotation}}},788:(t,e,n)=>{n.d(e,{w:()=>i});var r=n(269);class i{name;id;position;rotation;positionMatrix;rotationMatrix;rotationMatrixX;rotationMatrixY;rotationMatrixZ;right;up;back;lockAxis;yaw;pitch;roll;parent;child;velocity;angularVelocity;constructor(t){this.name=t.name,this.id=t.id,this.rotation=new Float32Array(t.rotation),this.positionMatrix=r.pB.translate(r.pB.identity(),t.position),this.position=new Float32Array(this.positionMatrix.buffer,48,3),this.rotationMatrix=r.pB.rotateX(r.pB.identity(),this.rotation[0]*Math.PI/180),this.rotationMatrix=r.pB.rotateY(this.rotationMatrix,this.rotation[1]*Math.PI/180),this.rotationMatrix=r.pB.rotateZ(this.rotationMatrix,this.rotation[2]*Math.PI/180),this.rotationMatrixX=r.pB.rotateX(r.pB.identity(),this.rotation[0]*Math.PI/180),this.rotationMatrixY=r.pB.rotateY(r.pB.identity(),this.rotation[1]*Math.PI/180),this.rotationMatrixZ=r.pB.rotateZ(r.pB.identity(),this.rotation[2]*Math.PI/180),this.right=new Float32Array(this.rotationMatrix.buffer,0,3),this.up=new Float32Array(this.rotationMatrix.buffer,16,3),this.back=new Float32Array(this.rotationMatrix.buffer,32,3),void 0!==t.lockAxis?this.lockAxis=t.lockAxis:this.lockAxis={x:!1,y:!1,z:!1},void 0!==t.velocity?this.velocity=r.eR.create(t.velocity.x,t.velocity.y,t.velocity.z):this.velocity=r.eR.create(0,0,0),void 0!==t.angularVelocity?this.angularVelocity=r.eR.create(t.angularVelocity.x,t.angularVelocity.y,t.angularVelocity.z):this.angularVelocity=r.eR.create(0,0,0),this.yaw=Math.atan2(this.back[0],this.back[2]),this.pitch=-Math.asin(this.back[1]),this.roll=Math.atan2(-this.up[0],this.right[0])}localMove(t,e,n){let i=r.eR.create(0,0,0);i=r.eR.addScaled(i,this.right,t),i=r.eR.addScaled(i,this.up,e),i=r.eR.addScaled(i,this.back,n),r.pB.translate(this.positionMatrix,i,this.positionMatrix),void 0!==this.child&&r.pB.translate(this.child.positionMatrix,i,this.child.positionMatrix)}globalMove(t,e,n){r.pB.translate(this.positionMatrix,[t,e,n],this.positionMatrix),void 0!==this.child&&r.pB.translate(this.child.positionMatrix,[t,e,n],this.child.positionMatrix)}localRotate(t,e,n){this.lockAxis.x||(this.pitch+=t*Math.PI/180,r.pB.rotateX(this.rotationMatrixX,t*Math.PI/180,this.rotationMatrixX),r.pB.rotateX(this.rotationMatrix,t*Math.PI/180,this.rotationMatrix)),this.lockAxis.y||(this.yaw+=e*Math.PI/180,r.pB.rotateY(this.rotationMatrixY,e*Math.PI/180,this.rotationMatrixY),r.pB.rotateY(this.rotationMatrix,e*Math.PI/180,this.rotationMatrix)),this.lockAxis.z||(this.roll+=n*Math.PI/180,r.pB.rotateZ(this.rotationMatrixZ,n*Math.PI/180,this.rotationMatrixZ),r.pB.rotateZ(this.rotationMatrix,n*Math.PI/180,this.rotationMatrix))}globalRotate(t,e,n){if(!this.lockAxis.x&&0!=t){this.pitch+=t*Math.PI/180;let e=r.pB.rotationX(t*Math.PI/180);this.rotationMatrix=r.pB.multiply(e,this.rotationMatrix),this.rotationMatrixX=r.pB.multiply(e,this.rotationMatrixX)}if(!this.lockAxis.y&&0!=e){this.yaw+=e*Math.PI/180;let t=r.pB.rotationY(e*Math.PI/180);if(this.rotationMatrix=r.pB.multiply(t,this.rotationMatrix),this.rotationMatrixY=r.pB.multiply(t,this.rotationMatrixY),void 0!==this.child){this.child.yaw+=e*Math.PI/180;let n=new Float32Array([this.child.position[0],this.position[1],this.child.position[2]]),i=r.eR.distance(this.position,n),o=new Float32Array(this.child.rotationMatrix.buffer,32,3),a=-e*Math.PI/180+this.angleBetween(new Float32Array([1,0]),new Float32Array([o[0],o[2]]));this.child.position[0]=i*Math.cos(a)+this.position[0],this.child.position[2]=i*Math.sin(a)+this.position[2],this.child.rotationMatrix=r.pB.multiply(t,this.child.rotationMatrix),this.child.rotationMatrixY=r.pB.multiply(t,this.child.rotationMatrixY)}}if(!this.lockAxis.z&&0!=n){this.roll+=n*Math.PI/180;let t=r.pB.rotationZ(n*Math.PI/180);this.rotationMatrix=r.pB.multiply(t,this.rotationMatrix),this.rotationMatrixZ=r.pB.multiply(t,this.rotationMatrixZ)}this.recalculateAngles()}rotateRelative(t,e){if(void 0!==this.child)if("x"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,0,3);this.angularVelocity=r.eR.lerp(this.angularVelocity,r.eR.scale(t,-e*Math.PI/180),.1)}else if("y"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,16,3);this.angularVelocity=r.eR.lerp(this.angularVelocity,r.eR.scale(t,-e*Math.PI/180),.1)}else{let t=new Float32Array(this.child.rotationMatrix.buffer,32,3);this.angularVelocity=r.eR.lerp(this.angularVelocity,r.eR.scale(t,-e*Math.PI/180),.1)}}addForce(t,e,n){r.eR.add(this.velocity,[t,e,n],this.velocity)}addLocalForce(t,e,n){let i=r.eR.create(0,0,0);i=r.eR.addScaled(i,this.right,t),i=r.eR.addScaled(i,this.up,e),i=r.eR.addScaled(i,this.back,n),r.eR.add(this.velocity,i,this.velocity)}addRelativeAngularForce(t,e){if(void 0!==this.child)if("x"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,0,3);r.eR.add(this.angularVelocity,r.eR.mulScalar(t,e),this.angularVelocity)}else if("y"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,16,3);r.eR.add(this.angularVelocity,r.eR.mulScalar(t,e),this.angularVelocity)}else{let t=new Float32Array(this.child.rotationMatrix.buffer,32,3);r.eR.add(this.angularVelocity,r.eR.mulScalar(t,e),this.angularVelocity)}}addRelativeTorque(t,e,n,i,o){if(void 0!==this.child){const a=600;let s=.4*n*i*i;if("x"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,0,3),n=r.eR.scale(t,e),i=r.eR.scale(n,1/s);r.eR.len(i)>a&&(i=r.eR.scale(i,a/r.eR.len(i)));let c=r.eR.scale(i,o);this.angularVelocity=r.eR.add(this.angularVelocity,c)}else if("y"==t){let t=new Float32Array(this.child.rotationMatrix.buffer,16,3),n=r.eR.scale(t,e),i=r.eR.scale(n,1/s);r.eR.len(i)>a&&(i=r.eR.scale(i,a/r.eR.len(i)));let c=r.eR.scale(i,o);this.angularVelocity=r.eR.add(this.angularVelocity,c)}else{let t=new Float32Array(this.child.rotationMatrix.buffer,32,3),n=r.eR.scale(t,e),i=r.eR.scale(n,1/s);r.eR.len(i)>a&&(i=r.eR.scale(i,a/r.eR.len(i)));let c=r.eR.scale(i,o);this.angularVelocity=r.eR.add(this.angularVelocity,c)}}}getPositionMatrix(){return this.positionMatrix}getRotationMatrix(){return this.rotationMatrix}getRotationMatrixX(){return this.rotationMatrixX}getRotationMatrixY(){return this.rotationMatrixY}getRotationMatrixZ(){return this.rotationMatrixZ}setPositionMatrix(t){this.positionMatrix=t}attachTo(t){this.parent=t}attach(t){this.child=t}getData(){}hashCode(){return this.name.split("").reduce(((t,e)=>e.charCodeAt(0)+(t<<6)+(t<<16)-t),0)}recalculateAngles(){this.yaw=Math.atan2(this.back[0],this.back[2]),this.pitch=-Math.asin(this.back[1]),this.roll=Math.atan2(-this.up[0],this.right[0])}angleBetween(t,e){let n=Math.atan2(t[1],t[0]),r=Math.atan2(e[1],e[0])-n;return r<0&&(r+=2*Math.PI),r}}},713:(t,e,n)=>{n.d(e,{I:()=>o});var r=n(269),i=n(343);class o extends i.y{vertices;sizeMatrix;length;constructor(t){super(t),this.length=t.lenght,this.sizeMatrix=r.pB.identity(),r.pB.scale(this.sizeMatrix,this.length,this.sizeMatrix),this.vertices=this.initVertices()}getLength(){return this.length}setLength(t){this.length=t,r.pB.scale(this.sizeMatrix,this.length,this.sizeMatrix)}getNormal(t,e,n){const i=r.eR.subtract(r.eR.create(t,e,n),this.position),o=r.pB.transpose(this.rotationMatrix),a=r.eR.transformMat4Upper3x3(i,o),s=[this.length[0]/2,this.length[1]/2,this.length[2]/2],c=[Math.abs(a[0])-s[0],Math.abs(a[1])-s[1],Math.abs(a[2])-s[2]];let u=0,l=Math.abs(c[0]);for(let t=1;t<3;t++){const e=Math.abs(c[t]);e<l&&(l=e,u=t)}const h=r.eR.create(0,0,0);h[u]=Math.sign(a[u]);const d=r.eR.transformMat4Upper3x3(h,this.rotationMatrix);return r.eR.normalize(d)}initVertices(){let t=new Float32Array([-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5]),e=new Array(0,.34,1/4,.34,0,.66,1/4,.66,.5,1,1/4,1,.5,.667,1/4,.667,3/4,.66,.5,.66,3/4,.34,.5,.34,1/4,0,.5,0,1/4,.33,.5,.33,.5,.66,.5,.34,1/4,.66,1/4,.34,1,.66,1,.34,3/4,.66,3/4,.34);void 0!==this.texture&&e.forEach(((t,n)=>{void 0!==this.texture&&(e[n]=n%2==0?(t+this.texture.indexX)/this.texture.atlas.rowElements:(t+this.texture.indexY)/this.texture.atlas.colElements)}));let n=new Float32Array([0,0,1,1,0,0,0,0,-1,-1,0,0,0,-1,0,0,1,0]),r=new Uint16Array([0,1,2,2,1,3,4,5,6,6,5,7,8,9,10,10,9,11,12,13,14,14,13,15,16,17,18,18,17,19,20,21,22,22,21,23]),i=new Float32Array(8*r.length);for(let o=0;o<r.length;o++){const a=3*r[o],s=t.slice(a,a+3);i.set(s,8*o);const c=3*(o/6|0),u=n.slice(c,c+3);i.set(u,8*o+3);const l=2*r[o],h=e.slice(l,l+2);i.set(h,8*o+6)}return i}mat3frommat4(t){return new Float32Array([t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]])}}},343:(t,e,n)=>{n.d(e,{y:()=>o});var r=n(269),i=n(788);class o extends i.w{color;texture;containsTexture;constructor(t){super(t),this.color=void 0!==t.color?new Float32Array(t.color):new Float32Array([.8,.5,.2,1]),this.texture=t.texture,this.containsTexture=void 0!==this.texture}getScaleMatrix(){return this.sizeMatrix}getData(){let t=r.pB.multiply(r.pB.multiply(this.positionMatrix,this.rotationMatrix),this.sizeMatrix);return{name:this.name,vertices:this.vertices,numberVertices:this.vertices.byteLength/8,matrix:t,color:this.color,containsTexture:this.containsTexture}}}},41:(t,e,n)=>{n.d(e,{i:()=>o});var r=n(269),i=n(343);class o extends i.y{radius;sizeMatrix;vertices;constructor(t){super(t),this.radius=t.radius,this.sizeMatrix=r.pB.identity(),this.setRadius(this.radius),this.vertices=this.initVertices(this.radius,16,16)}setRadius(t){this.radius=t,r.pB.scale(this.sizeMatrix,[t,t,t],this.sizeMatrix)}getRadius(){return this.radius}getNormal(t,e,n){return r.eR.normalize(r.eR.subtract(r.eR.create(t,e,n),this.position))}initVertices(t,e,n){const r=[],i=[];for(let r=0;r<=e;r++){const o=r*Math.PI/e,a=Math.sin(o),s=Math.cos(o);let c;c=void 0===this.texture?r/e:(r/e+this.texture.indexY)/this.texture.atlas.colElements;for(let e=0;e<=n;e++){const r=2*e*Math.PI/n,o=Math.sin(r),u=Math.cos(r);let l;l=void 0===this.texture?1-e/n:(1-e/n+this.texture?.indexX)/this.texture?.atlas.rowElements;const h=u*a,d=s,f=o*a;i.push([t*h,t*d,t*f,h,d,f,l,c])}}for(let t=0;t<e;t++)for(let e=0;e<n;e++){const o=t*(n+1)+e,a=o+1,s=o+(n+1),c=s+1;r.push(...i[o],...i[s],...i[a]),r.push(...i[a],...i[s],...i[c])}return new Float32Array(r)}}},170:(t,e,n)=>{n.d(e,{A:()=>i});var r=n(269);class i{canvas;device;context;presentationFormat;colorRenderPipeline;textureRenderPipeline;debugRenderPipeline;skyBoxRenderPipeline;renderPassDescriptor;multisamlpeTexture;renderTarget;renderTargetView;cameraBuffer;lightBuffer;objectsBindGroup;shapesMatrixBuffer;shapesColorBuffer;shapesTextureBuffer;debugColorBuffer;sampler;shapesColorBindGroup;shapesTextureBindGroup;debugBindGroup;skyboxBindGroup;skyboxCameraBuffer;constructor(t){this.canvas=t}async initialize(t,e){if(void 0===navigator.gpu)return console.log("This browser/device doesn't support WebGPU..."),void alert("This browser/device doesn't support WebGPU...");let n=await navigator.gpu.requestAdapter();if(console.log(n),this.device=await n.requestDevice(),void 0===this.device)return void console.log("Couldn't load device (not supported)");this.context=this.canvas.getContext("webgpu"),this.presentationFormat=navigator.gpu.getPreferredCanvasFormat(),this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.canvas.width=this.canvas.clientWidth*window.devicePixelRatio,this.canvas.height=this.canvas.clientHeight*window.devicePixelRatio;const r={label:"Objects bind group layout desc",entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform",hasDynamicOffset:!1}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform",hasDynamicOffset:!1}}]},i=this.device.createBindGroupLayout(r),o={label:"Shapes bind group layout descriptor",entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform",hasDynamicOffset:!0}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform",hasDynamicOffset:!0}}]},a=this.device.createBindGroupLayout(o),s={label:"Shapes texture bind group layout",entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform",hasDynamicOffset:!0}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}}]},c=this.device.createBindGroupLayout(s),u=this.device.createShaderModule({code:"struct Camera {\r\n    matrix: mat4x4f,\r\n};\r\n\r\nstruct Light {\r\n    direction: vec3f,\r\n}\r\n\r\nstruct VertexOutput {\r\n    @builtin(position) position: vec4f,\r\n    @location(0) normal: vec3f,\r\n    @location(1) texcoord: vec2f,\r\n};\r\n\r\n// Bind group for world\r\n@group(0) @binding(0) var<uniform> camera: Camera;\r\n@group(0) @binding(1) var<uniform> light: Light;\r\n\r\n// Bind group for objects\r\n@group(1) @binding(0) var<uniform> objTran: mat4x4f;\r\n@group(1) @binding(1) var<uniform> color: vec4f;\r\n\r\n@vertex\r\nfn vert(\r\n    @location(0) position: vec4f,\r\n    @location(1) normal: vec3f,\r\n    @location(2) texcoord: vec2f,\r\n    @builtin(vertex_index) vertIndex: u32\r\n) -> VertexOutput {\r\n    var vsOut: VertexOutput;\r\n    vsOut.position = camera.matrix * objTran * position;\r\n    vsOut.normal = (objTran * vec4f(normal, 0)).xyz;\r\n    vsOut.texcoord = texcoord;\r\n    return vsOut;\r\n}\r\n\r\n@fragment\r\nfn frag(vsOut: VertexOutput) -> @location(0) vec4f {\r\n    let normal = normalize(vsOut.normal);\r\n    let lgh = max(dot(normal, -light.direction), 0.25);\r\n    let col = color.rgb * lgh; // Multiply only color (not alpha)\r\n    // let col = color.rgb; // Multiply only color (not alpha)\r\n    return vec4f(col, color.a);\r\n}\r\n"}),l={label:"Color render pipeline",layout:this.device.createPipelineLayout({bindGroupLayouts:[i,a]}),vertex:{module:u,buffers:[{arrayStride:32,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x3"},{shaderLocation:2,offset:24,format:"float32x2"}]}]},fragment:{module:u,targets:[{format:this.presentationFormat}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"},multisample:{count:4}};this.colorRenderPipeline=this.device.createRenderPipeline(l);const h=this.device.createShaderModule({code:"struct Camera {\r\n    matrix: mat4x4f,\r\n};\r\n\r\nstruct Light {\r\n    direction: vec3f,\r\n}\r\n\r\nstruct VertexOutput {\r\n    @builtin(position) position: vec4f,\r\n    @location(0) normal: vec3f,\r\n    @location(1) texcoord: vec2f,\r\n};\r\n\r\n@group(0) @binding(0) var<uniform> camera: Camera;\r\n@group(0) @binding(1) var<uniform> light: Light;\r\n\r\n@group(1) @binding(0) var<uniform> objectTransform: mat4x4f;\r\n@group(1) @binding(1) var linSampler: sampler;\r\n@group(1) @binding(2) var tex: texture_2d<f32>;\r\n// @group(1) @binding(3) var<uniform> textureElements: vec2f;\r\n\r\n@vertex\r\nfn vert(\r\n    @location(0) position: vec4f,\r\n    @location(1) normal: vec3f,\r\n    @location(2) texcoord: vec2f,\r\n) -> VertexOutput {\r\n    var vsOut: VertexOutput;\r\n    vsOut.position = camera.matrix * objectTransform * position;\r\n    vsOut.normal = (objectTransform * vec4f(normal, 0)).xyz;\r\n    vsOut.texcoord = texcoord;\r\n    return vsOut;\r\n}\r\n\r\n\r\n@fragment\r\nfn frag(vsOut: VertexOutput) -> @location(0) vec4f {\r\n    let normal = normalize(vsOut.normal);\r\n    let texcolor = textureSample(tex, linSampler, vsOut.texcoord);\r\n    let lgh = max(dot(normal, -light.direction), 0.25);\r\n    let finalcolor = texcolor.rgb * lgh;\r\n    return vec4f(finalcolor, texcolor.a);\r\n}"}),d={label:"Texture render pipeline",layout:this.device.createPipelineLayout({bindGroupLayouts:[i,c]}),vertex:{module:h,buffers:[{arrayStride:32,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x3"},{shaderLocation:2,offset:24,format:"float32x2"}]}]},fragment:{module:h,targets:[{format:this.presentationFormat}]},primitive:{topology:"triangle-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"},multisample:{count:4}};this.textureRenderPipeline=this.device.createRenderPipeline(d);const f={label:"Debug bind group layout descriptor",entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform",hasDynamicOffset:!1}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform",hasDynamicOffset:!0}}]},p=this.device.createBindGroupLayout(f),m=this.device.createShaderModule({code:"struct Camera {\r\n    matrix: mat4x4f,\r\n};\r\n\r\nstruct VertexOutput {\r\n    @builtin(position) position: vec4f,\r\n};\r\n\r\n@group(0) @binding(0) var<uniform> camera: Camera;\r\n@group(0) @binding(1) var<uniform> color: vec3f;\r\n\r\n@vertex\r\nfn vert(\r\n    @location(0) position: vec4f,\r\n) -> VertexOutput {\r\n    var vsOut: VertexOutput;\r\n    vsOut.position = camera.matrix * position;\r\n    return vsOut;\r\n}\r\n\r\n@fragment\r\nfn frag() -> @location(0) vec4f {\r\n    return vec4f(color.rgb, 1);\r\n}\r\n"}),M={layout:this.device.createPipelineLayout({bindGroupLayouts:[p]}),vertex:{module:m,buffers:[{arrayStride:12,attributes:[{shaderLocation:0,offset:0,format:"float32x3"}]}]},fragment:{module:m,targets:[{format:this.presentationFormat}]},primitive:{topology:"line-list"},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"},multisample:{count:4}};this.debugRenderPipeline=this.device.createRenderPipeline(M);const g=this.device.createShaderModule({code:"struct Uniforms {\r\n  viewDirectionProjectionInverse: mat4x4f,\r\n};\r\n\r\nstruct VSOutput {\r\n  @builtin(position) position: vec4f,\r\n  @location(0) ndc: vec2f, // Normalized Device Coordinates (range -1 to 1)\r\n};\r\n\r\n@group(0) @binding(0) var<uniform> uni: Uniforms;\r\n@group(0) @binding(1) var ourSampler: sampler;\r\n@group(0) @binding(2) var ourTexture: texture_cube<f32>;\r\n\r\n@vertex fn vs(@builtin(vertex_index) vNdx: u32) -> VSOutput {\r\n  let pos = array(\r\n    vec2f(-1.0,  3.0),\r\n    vec2f(-1.0, -1.0),\r\n    vec2f( 3.0, -1.0),\r\n  );\r\n\r\n  let ndc = array(\r\n    vec2f(-1.0,  3.0),\r\n    vec2f(-1.0, -1.0),\r\n    vec2f( 3.0, -1.0),\r\n  );\r\n\r\n  var out: VSOutput;\r\n  out.position = vec4f(pos[vNdx], 1.0, 1.0);\r\n  out.ndc = ndc[vNdx];\r\n  return out;\r\n}\r\n\r\n@fragment fn fs(vsOut: VSOutput) -> @location(0) vec4f {\r\n  let clip = vec4f(vsOut.ndc.xy, 1.0, 1.0);\r\n  let worldDir = (uni.viewDirectionProjectionInverse * clip).xyz;\r\n  return textureSample(ourTexture, ourSampler, worldDir);\r\n}\r\n"}),v={label:"skybox render pipeline",layout:"auto",vertex:{module:g},fragment:{module:g,targets:[{format:this.presentationFormat}]},depthStencil:{depthWriteEnabled:!0,depthCompare:"less-equal",format:"depth24plus"},multisample:{count:4}};this.skyBoxRenderPipeline=this.device.createRenderPipeline(v);const x=this.createTextureFromImages(this.device,[e+"px.jpg",e+"nx.jpg",e+"py.jpg",e+"ny.jpg",e+"pz.jpg",e+"nz.jpg"]),w=this.device.createSampler({magFilter:"linear",minFilter:"linear"});this.cameraBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.lightBuffer=this.device.createBuffer({label:"Meduspremnik za svjetlo",size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.objectsBindGroup=this.device.createBindGroup({layout:this.colorRenderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.cameraBuffer,offset:0,size:64}},{binding:1,resource:{buffer:this.lightBuffer,offset:0,size:16}}]}),this.shapesMatrixBuffer=this.device.createBuffer({label:"Meduspremnik za matrice oblika",size:65536,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.shapesColorBuffer=this.device.createBuffer({label:"Meduspremnik za boje oblika",size:16384,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.shapesTextureBuffer=this.device.createTexture({label:"Meduspremnik za teksture oblika",format:"rgba8unorm",size:[t.image.width,t.image.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),this.device.queue.copyExternalImageToTexture({source:t.image},{texture:this.shapesTextureBuffer},{width:t.image.width,height:t.image.height}),this.debugColorBuffer=this.device.createBuffer({label:"Meduspremnik za boje u debugu",size:16384,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.sampler=this.device.createSampler({addressModeU:"repeat",addressModeV:"repeat"}),this.shapesColorBindGroup=this.device.createBindGroup({layout:this.colorRenderPipeline.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:this.shapesMatrixBuffer,size:64}},{binding:1,resource:{buffer:this.shapesColorBuffer,size:16}}]}),this.shapesTextureBindGroup=this.device.createBindGroup({layout:this.textureRenderPipeline.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:this.shapesMatrixBuffer,size:64}},{binding:1,resource:this.sampler},{binding:2,resource:this.shapesTextureBuffer.createView()}]}),this.debugBindGroup=this.device.createBindGroup({layout:this.debugRenderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.cameraBuffer,size:64}},{binding:1,resource:{buffer:this.debugColorBuffer,size:16}}]}),this.skyboxCameraBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.skyboxBindGroup=this.device.createBindGroup({label:"skybox bind group",layout:this.skyBoxRenderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.skyboxCameraBuffer}},{binding:1,resource:w},{binding:2,resource:(await x).createView({dimension:"cube"})}]});const y=this.device.createTexture({size:[this.context.getCurrentTexture().width,this.context.getCurrentTexture().height],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT,sampleCount:4});this.renderPassDescriptor={colorAttachments:[{clearValue:[.2,.2,.2,1],loadOp:"clear",storeOp:"store"}],depthStencilAttachment:{view:y.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"discard"}}}copySourcesToTexture(t,e,n){n.forEach(((n,r)=>{t.queue.copyExternalImageToTexture({source:n},{texture:e,origin:[0,0,r]},{width:n.width,height:n.height})}))}createTextureFromSources(t,e){const n=e[0],r=t.createTexture({format:"rgba8unorm",size:[n.width,n.height,e.length],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});return this.copySourcesToTexture(t,r,e),r}async loadImageBitmap(t){const e=await fetch(t),n=await e.blob();return await createImageBitmap(n)}async createTextureFromImages(t,e){const n=await Promise.all(e.map(this.loadImageBitmap));return this.createTextureFromSources(t,n)}render(t){const e=this.context.getCurrentTexture();this.multisamlpeTexture&&this.multisamlpeTexture.width===e.width&&this.multisamlpeTexture.height===e.height||(this.multisamlpeTexture&&this.multisamlpeTexture.destroy(),this.multisamlpeTexture=this.device.createTexture({format:e.format,usage:GPUTextureUsage.RENDER_ATTACHMENT,size:[e.width,e.height],sampleCount:4}));const n=this.device.createCommandEncoder({label:"Default encoder"});this.renderPassDescriptor.colorAttachments[0].view=this.multisamlpeTexture.createView(),this.renderPassDescriptor.colorAttachments[0].resolveTarget=e.createView();const i=n.beginRenderPass(this.renderPassDescriptor);let o=t.camera.getData(),a=r.pB.multiply(o.projection,o.camera);this.device.queue.writeBuffer(this.cameraBuffer,0,a),this.device.queue.writeBuffer(this.lightBuffer,0,t.light.getData()),t.vectors.forEach(((t,e)=>{i.setBindGroup(0,this.debugBindGroup,[256*e]),i.setPipeline(this.debugRenderPipeline);let n=t.getData();const r=this.device.createBuffer({label:"Vertex buffer for debugging",size:n.data.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(r,0,n.data),this.device.queue.writeBuffer(this.debugColorBuffer,256*e,n.color),i.setVertexBuffer(0,r),i.draw(2)})),i.setBindGroup(0,this.objectsBindGroup);let s=0;t.shapes.forEach((t=>{let e=t.getData();e.containsTexture?(i.setPipeline(this.textureRenderPipeline),i.setBindGroup(1,this.shapesTextureBindGroup,[256*s]),this.device.queue.writeBuffer(this.shapesMatrixBuffer,256*s,e.matrix)):(i.setPipeline(this.colorRenderPipeline),i.setBindGroup(1,this.shapesColorBindGroup,[256*s,256*s]),this.device.queue.writeBuffer(this.shapesMatrixBuffer,256*s,e.matrix),this.device.queue.writeBuffer(this.shapesColorBuffer,256*s,e.color));const n=this.device.createBuffer({label:`Vertex buffer for ${e.name}`,size:4*e.vertices.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST});this.device.queue.writeBuffer(n,0,e.vertices),i.setVertexBuffer(0,n),i.draw(e.numberVertices),s+=1}));let c=new Float32Array(o.camera);c.set([0,0,0],12);let u=r.pB.multiply(o.projection,c);this.device.queue.writeBuffer(this.skyboxCameraBuffer,0,u),i.setPipeline(this.skyBoxRenderPipeline),i.setBindGroup(0,this.skyboxBindGroup),i.draw(3),i.end();const l=n.finish();this.device.queue.submit([l])}}},612:(t,e,n)=>{n.d(e,{Z:()=>r});class r{shapes;vectors;light;camera;constructor(){this.shapes=new Array,this.vectors=new Array}addShapes(...t){for(let e of t)this.shapes.includes(e)||this.shapes.push(e)}removeShapes(...t){for(let e of t)this.shapes=this.shapes.splice(this.shapes.indexOf(e))}setLight(t){this.light=t}setCamera(t){this.camera=t}}},796:(t,e,n)=>{n.d(e,{L:()=>r});class r{image;rowElements;colElements;async loadImage(t,e,n){this.image=await this.loadImageBitmap(t),this.rowElements=e,this.colElements=n}async loadImageBitmap(t){const e=await fetch(t),n=await e.blob();return await createImageBitmap(n,{colorSpaceConversion:"none"})}}},269:(t,e,n)=>{n.d(e,{eR:()=>R,pB:()=>y});const r=(i=Array,o=t=>t.fill(0),class extends i{constructor(...t){super(...t),o(this)}});var i,o;let a=1e-6;const s=new Map;function c(t){let e=s.get(t);return e||(e=function(t){function e(e=0,n=0){const r=new t(2);return void 0!==e&&(r[0]=e,void 0!==n&&(r[1]=n)),r}function n(e,n,r){const i=r??new t(2);return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i}function r(e,n,r,i){const o=i??new t(2);return o[0]=e[0]+r*(n[0]-e[0]),o[1]=e[1]+r*(n[1]-e[1]),o}function i(e,n,r){const i=r??new t(2);return i[0]=e[0]*n,i[1]=e[1]*n,i}function o(e,n){const r=n??new t(2);return r[0]=1/e[0],r[1]=1/e[1],r}function s(t,e){return t[0]*e[0]+t[1]*e[1]}function c(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function u(t){const e=t[0],n=t[1];return e*e+n*n}function l(t,e){const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function h(t,e){const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function d(e,n){const r=n??new t(2),i=e[0],o=e[1],a=Math.sqrt(i*i+o*o);return a>1e-5?(r[0]=i/a,r[1]=o/a):(r[0]=0,r[1]=0),r}function f(e,n){const r=n??new t(2);return r[0]=e[0],r[1]=e[1],r}function p(e,n,r){const i=r??new t(2);return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i}function m(e,n,r){const i=r??new t(2);return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i}function M(e,n,r){const o=r??new t(2);return d(e,o),i(o,n,o)}return{create:e,fromValues:e,set:function(e,n,r){const i=r??new t(2);return i[0]=e,i[1]=n,i},ceil:function(e,n){const r=n??new t(2);return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r},floor:function(e,n){const r=n??new t(2);return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r},round:function(e,n){const r=n??new t(2);return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r},clamp:function(e,n=0,r=1,i){const o=i??new t(2);return o[0]=Math.min(r,Math.max(n,e[0])),o[1]=Math.min(r,Math.max(n,e[1])),o},add:function(e,n,r){const i=r??new t(2);return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i},addScaled:function(e,n,r,i){const o=i??new t(2);return o[0]=e[0]+n[0]*r,o[1]=e[1]+n[1]*r,o},angle:function(t,e){const n=t[0],r=t[1],i=e[0],o=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),c=a&&s(t,e)/a;return Math.acos(c)},subtract:n,sub:n,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},lerp:r,lerpV:function(e,n,r,i){const o=i??new t(2);return o[0]=e[0]+r[0]*(n[0]-e[0]),o[1]=e[1]+r[1]*(n[1]-e[1]),o},max:function(e,n,r){const i=r??new t(2);return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i},min:function(e,n,r){const i=r??new t(2);return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i},mulScalar:i,scale:i,divScalar:function(e,n,r){const i=r??new t(2);return i[0]=e[0]/n,i[1]=e[1]/n,i},inverse:o,invert:o,cross:function(e,n,r){const i=r??new t(3),o=e[0]*n[1]-e[1]*n[0];return i[0]=0,i[1]=0,i[2]=o,i},dot:s,length:c,len:c,lengthSq:u,lenSq:u,distance:l,dist:l,distanceSq:h,distSq:h,normalize:d,negate:function(e,n){const r=n??new t(2);return r[0]=-e[0],r[1]=-e[1],r},copy:f,clone:f,multiply:p,mul:p,divide:m,div:m,random:function(e=1,n){const r=n??new t(2),i=2*Math.random()*Math.PI;return r[0]=Math.cos(i)*e,r[1]=Math.sin(i)*e,r},zero:function(e){const n=e??new t(2);return n[0]=0,n[1]=0,n},transformMat4:function(e,n,r){const i=r??new t(2),o=e[0],a=e[1];return i[0]=o*n[0]+a*n[4]+n[12],i[1]=o*n[1]+a*n[5]+n[13],i},transformMat3:function(e,n,r){const i=r??new t(2),o=e[0],a=e[1];return i[0]=n[0]*o+n[4]*a+n[8],i[1]=n[1]*o+n[5]*a+n[9],i},rotate:function(e,n,r,i){const o=i??new t(2),a=e[0]-n[0],s=e[1]-n[1],c=Math.sin(r),u=Math.cos(r);return o[0]=a*u-s*c+n[0],o[1]=a*c+s*u+n[1],o},setLength:M,truncate:function(e,n,r){const i=r??new t(2);return c(e)>n?M(e,n,i):f(e,i)},midpoint:function(e,n,i){return r(e,n,.5,i??new t(2))}}}(t),s.set(t,e)),e}const u=new Map;function l(t){let e=u.get(t);return e||(e=function(t){function e(e,n,r){const i=new t(3);return void 0!==e&&(i[0]=e,void 0!==n&&(i[1]=n,void 0!==r&&(i[2]=r))),i}function n(e,n,r){const i=r??new t(3);return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i}function r(e,n,r,i){const o=i??new t(3);return o[0]=e[0]+r*(n[0]-e[0]),o[1]=e[1]+r*(n[1]-e[1]),o[2]=e[2]+r*(n[2]-e[2]),o}function i(e,n,r){const i=r??new t(3);return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i}function o(e,n){const r=n??new t(3);return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function c(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function u(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function l(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function h(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function d(e,n){const r=n??new t(3),i=e[0],o=e[1],a=e[2],s=Math.sqrt(i*i+o*o+a*a);return s>1e-5?(r[0]=i/s,r[1]=o/s,r[2]=a/s):(r[0]=0,r[1]=0,r[2]=0),r}function f(e,n){const r=n??new t(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function p(e,n,r){const i=r??new t(3);return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i}function m(e,n,r){const i=r??new t(3);return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i[2]=e[2]/n[2],i}function M(e,n,r){const o=r??new t(3);return d(e,o),i(o,n,o)}return{create:e,fromValues:e,set:function(e,n,r,i){const o=i??new t(3);return o[0]=e,o[1]=n,o[2]=r,o},ceil:function(e,n){const r=n??new t(3);return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r},floor:function(e,n){const r=n??new t(3);return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r},round:function(e,n){const r=n??new t(3);return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r},clamp:function(e,n=0,r=1,i){const o=i??new t(3);return o[0]=Math.min(r,Math.max(n,e[0])),o[1]=Math.min(r,Math.max(n,e[1])),o[2]=Math.min(r,Math.max(n,e[2])),o},add:function(e,n,r){const i=r??new t(3);return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i},addScaled:function(e,n,r,i){const o=i??new t(3);return o[0]=e[0]+n[0]*r,o[1]=e[1]+n[1]*r,o[2]=e[2]+n[2]*r,o},angle:function(t,e){const n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],c=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+c*c),l=u&&s(t,e)/u;return Math.acos(l)},subtract:n,sub:n,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a&&Math.abs(t[2]-e[2])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},lerp:r,lerpV:function(e,n,r,i){const o=i??new t(3);return o[0]=e[0]+r[0]*(n[0]-e[0]),o[1]=e[1]+r[1]*(n[1]-e[1]),o[2]=e[2]+r[2]*(n[2]-e[2]),o},max:function(e,n,r){const i=r??new t(3);return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i},min:function(e,n,r){const i=r??new t(3);return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i},mulScalar:i,scale:i,divScalar:function(e,n,r){const i=r??new t(3);return i[0]=e[0]/n,i[1]=e[1]/n,i[2]=e[2]/n,i},inverse:o,invert:o,cross:function(e,n,r){const i=r??new t(3),o=e[2]*n[0]-e[0]*n[2],a=e[0]*n[1]-e[1]*n[0];return i[0]=e[1]*n[2]-e[2]*n[1],i[1]=o,i[2]=a,i},dot:s,length:c,len:c,lengthSq:u,lenSq:u,distance:l,dist:l,distanceSq:h,distSq:h,normalize:d,negate:function(e,n){const r=n??new t(3);return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r},copy:f,clone:f,multiply:p,mul:p,divide:m,div:m,random:function(e=1,n){const r=n??new t(3),i=2*Math.random()*Math.PI,o=2*Math.random()-1,a=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(i)*a,r[1]=Math.sin(i)*a,r[2]=o*e,r},zero:function(e){const n=e??new t(3);return n[0]=0,n[1]=0,n[2]=0,n},transformMat4:function(e,n,r){const i=r??new t(3),o=e[0],a=e[1],s=e[2],c=n[3]*o+n[7]*a+n[11]*s+n[15]||1;return i[0]=(n[0]*o+n[4]*a+n[8]*s+n[12])/c,i[1]=(n[1]*o+n[5]*a+n[9]*s+n[13])/c,i[2]=(n[2]*o+n[6]*a+n[10]*s+n[14])/c,i},transformMat4Upper3x3:function(e,n,r){const i=r??new t(3),o=e[0],a=e[1],s=e[2];return i[0]=o*n[0]+a*n[4]+s*n[8],i[1]=o*n[1]+a*n[5]+s*n[9],i[2]=o*n[2]+a*n[6]+s*n[10],i},transformMat3:function(e,n,r){const i=r??new t(3),o=e[0],a=e[1],s=e[2];return i[0]=o*n[0]+a*n[4]+s*n[8],i[1]=o*n[1]+a*n[5]+s*n[9],i[2]=o*n[2]+a*n[6]+s*n[10],i},transformQuat:function(e,n,r){const i=r??new t(3),o=n[0],a=n[1],s=n[2],c=2*n[3],u=e[0],l=e[1],h=e[2],d=a*h-s*l,f=s*u-o*h,p=o*l-a*u;return i[0]=u+d*c+2*(a*p-s*f),i[1]=l+f*c+2*(s*d-o*p),i[2]=h+p*c+2*(o*f-a*d),i},getTranslation:function(e,n){const r=n??new t(3);return r[0]=e[12],r[1]=e[13],r[2]=e[14],r},getAxis:function(e,n,r){const i=r??new t(3),o=4*n;return i[0]=e[o+0],i[1]=e[o+1],i[2]=e[o+2],i},getScaling:function(e,n){const r=n??new t(3),i=e[0],o=e[1],a=e[2],s=e[4],c=e[5],u=e[6],l=e[8],h=e[9],d=e[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+c*c+u*u),r[2]=Math.sqrt(l*l+h*h+d*d),r},rotateX:function(e,n,r,i){const o=i??new t(3),a=[],s=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],s[0]=a[0],s[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),s[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},rotateY:function(e,n,r,i){const o=i??new t(3),a=[],s=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],s[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),s[1]=a[1],s[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},rotateZ:function(e,n,r,i){const o=i??new t(3),a=[],s=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],s[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),s[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),s[2]=a[2],o[0]=s[0]+n[0],o[1]=s[1]+n[1],o[2]=s[2]+n[2],o},setLength:M,truncate:function(e,n,r){const i=r??new t(3);return c(e)>n?M(e,n,i):f(e,i)},midpoint:function(e,n,i){return r(e,n,.5,i??new t(3))}}}(t),u.set(t,e)),e}const h=new Map;function d(t){let e=h.get(t);return e||(e=function(t){const e=c(t),n=l(t);function r(e,n){const r=n??new t(12);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[8]=e[8],r[9]=e[9],r[10]=e[10],r}function i(e){const n=e??new t(12);return n[0]=1,n[1]=0,n[2]=0,n[4]=0,n[5]=1,n[6]=0,n[8]=0,n[9]=0,n[10]=1,n}function o(e,n){const r=n??new t(12),i=e[0],o=e[1],a=e[2],s=e[4],c=e[5],u=e[6],l=e[8],h=e[9],d=e[10],f=d*c-u*h,p=-d*s+u*l,m=h*s-c*l,M=1/(i*f+o*p+a*m);return r[0]=f*M,r[1]=(-d*o+a*h)*M,r[2]=(u*o-a*c)*M,r[4]=p*M,r[5]=(d*i-a*l)*M,r[6]=(-u*i+a*s)*M,r[8]=m*M,r[9]=(-h*i+o*l)*M,r[10]=(c*i-o*s)*M,r}function s(e,n,r){const i=r??new t(12),o=e[0],a=e[1],s=e[2],c=e[4],u=e[5],l=e[6],h=e[8],d=e[9],f=e[10],p=n[0],m=n[1],M=n[2],g=n[4],v=n[5],x=n[6],w=n[8],y=n[9],b=n[10];return i[0]=o*p+c*m+h*M,i[1]=a*p+u*m+d*M,i[2]=s*p+l*m+f*M,i[4]=o*g+c*v+h*x,i[5]=a*g+u*v+d*x,i[6]=s*g+l*v+f*x,i[8]=o*w+c*y+h*b,i[9]=a*w+u*y+d*b,i[10]=s*w+l*y+f*b,i}function u(e,n){const r=n??new t(12),i=Math.cos(e),o=Math.sin(e);return r[0]=i,r[1]=o,r[2]=0,r[4]=-o,r[5]=i,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r}function h(e,n,r){const i=r??new t(12),o=e[0],a=e[1],s=e[2],c=e[4],u=e[5],l=e[6],h=Math.cos(n),d=Math.sin(n);return i[0]=h*o+d*c,i[1]=h*a+d*u,i[2]=h*s+d*l,i[4]=h*c-d*o,i[5]=h*u-d*a,i[6]=h*l-d*s,e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10]),i}return{clone:r,create:function(e,n,r,i,o,a,s,c,u){const l=new t(12);return l[3]=0,l[7]=0,l[11]=0,void 0!==e&&(l[0]=e,void 0!==n&&(l[1]=n,void 0!==r&&(l[2]=r,void 0!==i&&(l[4]=i,void 0!==o&&(l[5]=o,void 0!==a&&(l[6]=a,void 0!==s&&(l[8]=s,void 0!==c&&(l[9]=c,void 0!==u&&(l[10]=u))))))))),l},set:function(e,n,r,i,o,a,s,c,u,l){const h=l??new t(12);return h[0]=e,h[1]=n,h[2]=r,h[3]=0,h[4]=i,h[5]=o,h[6]=a,h[7]=0,h[8]=s,h[9]=c,h[10]=u,h[11]=0,h},fromMat4:function(e,n){const r=n??new t(12);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=0,r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=0,r},fromQuat:function(e,n){const r=n??new t(12),i=e[0],o=e[1],a=e[2],s=e[3],c=i+i,u=o+o,l=a+a,h=i*c,d=o*c,f=o*u,p=a*c,m=a*u,M=a*l,g=s*c,v=s*u,x=s*l;return r[0]=1-f-M,r[1]=d+x,r[2]=p-v,r[3]=0,r[4]=d-x,r[5]=1-h-M,r[6]=m+g,r[7]=0,r[8]=p+v,r[9]=m-g,r[10]=1-h-f,r[11]=0,r},negate:function(e,n){const r=n??new t(12);return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[8]=-e[8],r[9]=-e[9],r[10]=-e[10],r},copy:r,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a&&Math.abs(t[2]-e[2])<a&&Math.abs(t[4]-e[4])<a&&Math.abs(t[5]-e[5])<a&&Math.abs(t[6]-e[6])<a&&Math.abs(t[8]-e[8])<a&&Math.abs(t[9]-e[9])<a&&Math.abs(t[10]-e[10])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]},identity:i,transpose:function(e,n){const r=n??new t(12);if(r===e){let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,r}const i=e[0],o=e[1],a=e[2],s=e[4],c=e[5],u=e[6],l=e[8],h=e[9],d=e[10];return r[0]=i,r[1]=s,r[2]=l,r[4]=o,r[5]=c,r[6]=h,r[8]=a,r[9]=u,r[10]=d,r},inverse:o,invert:o,determinant:function(t){const e=t[0],n=t[1],r=t[2],i=t[4],o=t[5],a=t[6],s=t[8],c=t[9],u=t[10];return e*(o*u-c*a)-i*(n*u-c*r)+s*(n*a-o*r)},mul:s,multiply:s,setTranslation:function(t,e,n){const r=n??i();return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[4]=t[4],r[5]=t[5],r[6]=t[6]),r[8]=e[0],r[9]=e[1],r[10]=1,r},getTranslation:function(t,n){const r=n??e.create();return r[0]=t[8],r[1]=t[9],r},getAxis:function(t,n,r){const i=r??e.create(),o=4*n;return i[0]=t[o+0],i[1]=t[o+1],i},setAxis:function(t,e,n,i){const o=i===t?t:r(t,i),a=4*n;return o[a+0]=e[0],o[a+1]=e[1],o},getScaling:function(t,n){const r=n??e.create(),i=t[0],o=t[1],a=t[4],s=t[5];return r[0]=Math.sqrt(i*i+o*o),r[1]=Math.sqrt(a*a+s*s),r},get3DScaling:function(t,e){const r=e??n.create(),i=t[0],o=t[1],a=t[2],s=t[4],c=t[5],u=t[6],l=t[8],h=t[9],d=t[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+c*c+u*u),r[2]=Math.sqrt(l*l+h*h+d*d),r},translation:function(e,n){const r=n??new t(12);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=1,r[6]=0,r[8]=e[0],r[9]=e[1],r[10]=1,r},translate:function(e,n,r){const i=r??new t(12),o=n[0],a=n[1],s=e[0],c=e[1],u=e[2],l=e[4],h=e[5],d=e[6],f=e[8],p=e[9],m=e[10];return e!==i&&(i[0]=s,i[1]=c,i[2]=u,i[4]=l,i[5]=h,i[6]=d),i[8]=s*o+l*a+f,i[9]=c*o+h*a+p,i[10]=u*o+d*a+m,i},rotation:u,rotate:h,rotationX:function(e,n){const r=n??new t(12),i=Math.cos(e),o=Math.sin(e);return r[0]=1,r[1]=0,r[2]=0,r[4]=0,r[5]=i,r[6]=o,r[8]=0,r[9]=-o,r[10]=i,r},rotateX:function(e,n,r){const i=r??new t(12),o=e[4],a=e[5],s=e[6],c=e[8],u=e[9],l=e[10],h=Math.cos(n),d=Math.sin(n);return i[4]=h*o+d*c,i[5]=h*a+d*u,i[6]=h*s+d*l,i[8]=h*c-d*o,i[9]=h*u-d*a,i[10]=h*l-d*s,e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),i},rotationY:function(e,n){const r=n??new t(12),i=Math.cos(e),o=Math.sin(e);return r[0]=i,r[1]=0,r[2]=-o,r[4]=0,r[5]=1,r[6]=0,r[8]=o,r[9]=0,r[10]=i,r},rotateY:function(e,n,r){const i=r??new t(12),o=e[0],a=e[1],s=e[2],c=e[8],u=e[9],l=e[10],h=Math.cos(n),d=Math.sin(n);return i[0]=h*o-d*c,i[1]=h*a-d*u,i[2]=h*s-d*l,i[8]=h*c+d*o,i[9]=h*u+d*a,i[10]=h*l+d*s,e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6]),i},rotationZ:u,rotateZ:h,scaling:function(e,n){const r=n??new t(12);return r[0]=e[0],r[1]=0,r[2]=0,r[4]=0,r[5]=e[1],r[6]=0,r[8]=0,r[9]=0,r[10]=1,r},scale:function(e,n,r){const i=r??new t(12),o=n[0],a=n[1];return i[0]=o*e[0],i[1]=o*e[1],i[2]=o*e[2],i[4]=a*e[4],i[5]=a*e[5],i[6]=a*e[6],e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10]),i},uniformScaling:function(e,n){const r=n??new t(12);return r[0]=e,r[1]=0,r[2]=0,r[4]=0,r[5]=e,r[6]=0,r[8]=0,r[9]=0,r[10]=1,r},uniformScale:function(e,n,r){const i=r??new t(12);return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[4]=n*e[4],i[5]=n*e[5],i[6]=n*e[6],e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10]),i},scaling3D:function(e,n){const r=n??new t(12);return r[0]=e[0],r[1]=0,r[2]=0,r[4]=0,r[5]=e[1],r[6]=0,r[8]=0,r[9]=0,r[10]=e[2],r},scale3D:function(e,n,r){const i=r??new t(12),o=n[0],a=n[1],s=n[2];return i[0]=o*e[0],i[1]=o*e[1],i[2]=o*e[2],i[4]=a*e[4],i[5]=a*e[5],i[6]=a*e[6],i[8]=s*e[8],i[9]=s*e[9],i[10]=s*e[10],i},uniformScaling3D:function(e,n){const r=n??new t(12);return r[0]=e,r[1]=0,r[2]=0,r[4]=0,r[5]=e,r[6]=0,r[8]=0,r[9]=0,r[10]=e,r},uniformScale3D:function(e,n,r){const i=r??new t(12);return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[4]=n*e[4],i[5]=n*e[5],i[6]=n*e[6],i[8]=n*e[8],i[9]=n*e[9],i[10]=n*e[10],i}}}(t),h.set(t,e)),e}const f=new Map;function p(t){let e=f.get(t);return e||(e=function(t){const e=l(t);function n(e,n){const r=n??new t(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}const r=n;function i(e){const n=e??new t(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function o(e,n){const r=n??new t(16),i=e[0],o=e[1],a=e[2],s=e[3],c=e[4],u=e[5],l=e[6],h=e[7],d=e[8],f=e[9],p=e[10],m=e[11],M=e[12],g=e[13],v=e[14],x=e[15],w=p*x,y=v*m,b=l*x,B=v*h,R=l*m,P=p*h,k=a*x,S=v*s,T=a*m,I=p*s,A=a*h,D=l*s,E=d*g,F=M*f,q=c*g,z=M*u,V=c*f,G=d*u,U=i*g,O=M*o,C=i*f,L=d*o,Y=i*u,j=c*o,_=w*u+B*f+R*g-(y*u+b*f+P*g),X=y*o+k*f+I*g-(w*o+S*f+T*g),N=b*o+S*u+A*g-(B*o+k*u+D*g),Z=P*o+T*u+D*f-(R*o+I*u+A*f),K=1/(i*_+c*X+d*N+M*Z);return r[0]=K*_,r[1]=K*X,r[2]=K*N,r[3]=K*Z,r[4]=K*(y*c+b*d+P*M-(w*c+B*d+R*M)),r[5]=K*(w*i+S*d+T*M-(y*i+k*d+I*M)),r[6]=K*(B*i+k*c+D*M-(b*i+S*c+A*M)),r[7]=K*(R*i+I*c+A*d-(P*i+T*c+D*d)),r[8]=K*(E*h+z*m+V*x-(F*h+q*m+G*x)),r[9]=K*(F*s+U*m+L*x-(E*s+O*m+C*x)),r[10]=K*(q*s+O*h+Y*x-(z*s+U*h+j*x)),r[11]=K*(G*s+C*h+j*m-(V*s+L*h+Y*m)),r[12]=K*(q*p+G*v+F*l-(V*v+E*l+z*p)),r[13]=K*(C*v+E*a+O*p-(U*p+L*v+F*a)),r[14]=K*(U*l+j*v+z*a-(Y*v+q*a+O*l)),r[15]=K*(Y*p+V*a+L*l-(C*l+j*p+G*a)),r}const s=o;function c(e,n,r){const i=r??new t(16),o=e[0],a=e[1],s=e[2],c=e[3],u=e[4],l=e[5],h=e[6],d=e[7],f=e[8],p=e[9],m=e[10],M=e[11],g=e[12],v=e[13],x=e[14],w=e[15],y=n[0],b=n[1],B=n[2],R=n[3],P=n[4],k=n[5],S=n[6],T=n[7],I=n[8],A=n[9],D=n[10],E=n[11],F=n[12],q=n[13],z=n[14],V=n[15];return i[0]=o*y+u*b+f*B+g*R,i[1]=a*y+l*b+p*B+v*R,i[2]=s*y+h*b+m*B+x*R,i[3]=c*y+d*b+M*B+w*R,i[4]=o*P+u*k+f*S+g*T,i[5]=a*P+l*k+p*S+v*T,i[6]=s*P+h*k+m*S+x*T,i[7]=c*P+d*k+M*S+w*T,i[8]=o*I+u*A+f*D+g*E,i[9]=a*I+l*A+p*D+v*E,i[10]=s*I+h*A+m*D+x*E,i[11]=c*I+d*A+M*D+w*E,i[12]=o*F+u*q+f*z+g*V,i[13]=a*F+l*q+p*z+v*V,i[14]=s*F+h*q+m*z+x*V,i[15]=c*F+d*q+M*z+w*V,i}const u=c,h=e.create(),d=e.create(),f=e.create();function p(e,n,r){const i=r??new t(16);let o=e[0],a=e[1],s=e[2];const c=Math.sqrt(o*o+a*a+s*s);o/=c,a/=c,s/=c;const u=o*o,l=a*a,h=s*s,d=Math.cos(n),f=Math.sin(n),p=1-d;return i[0]=u+(1-u)*d,i[1]=o*a*p+s*f,i[2]=o*s*p-a*f,i[3]=0,i[4]=o*a*p-s*f,i[5]=l+(1-l)*d,i[6]=a*s*p+o*f,i[7]=0,i[8]=o*s*p+a*f,i[9]=a*s*p-o*f,i[10]=h+(1-h)*d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function m(e,n,r,i){const o=i??new t(16);let a=n[0],s=n[1],c=n[2];const u=Math.sqrt(a*a+s*s+c*c);a/=u,s/=u,c/=u;const l=a*a,h=s*s,d=c*c,f=Math.cos(r),p=Math.sin(r),m=1-f,M=l+(1-l)*f,g=a*s*m+c*p,v=a*c*m-s*p,x=a*s*m-c*p,w=h+(1-h)*f,y=s*c*m+a*p,b=a*c*m+s*p,B=s*c*m-a*p,R=d+(1-d)*f,P=e[0],k=e[1],S=e[2],T=e[3],I=e[4],A=e[5],D=e[6],E=e[7],F=e[8],q=e[9],z=e[10],V=e[11];return o[0]=M*P+g*I+v*F,o[1]=M*k+g*A+v*q,o[2]=M*S+g*D+v*z,o[3]=M*T+g*E+v*V,o[4]=x*P+w*I+y*F,o[5]=x*k+w*A+y*q,o[6]=x*S+w*D+y*z,o[7]=x*T+w*E+y*V,o[8]=b*P+B*I+R*F,o[9]=b*k+B*A+R*q,o[10]=b*S+B*D+R*z,o[11]=b*T+B*E+R*V,e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}return{create:function(e,n,r,i,o,a,s,c,u,l,h,d,f,p,m,M){const g=new t(16);return void 0!==e&&(g[0]=e,void 0!==n&&(g[1]=n,void 0!==r&&(g[2]=r,void 0!==i&&(g[3]=i,void 0!==o&&(g[4]=o,void 0!==a&&(g[5]=a,void 0!==s&&(g[6]=s,void 0!==c&&(g[7]=c,void 0!==u&&(g[8]=u,void 0!==l&&(g[9]=l,void 0!==h&&(g[10]=h,void 0!==d&&(g[11]=d,void 0!==f&&(g[12]=f,void 0!==p&&(g[13]=p,void 0!==m&&(g[14]=m,void 0!==M&&(g[15]=M)))))))))))))))),g},set:function(e,n,r,i,o,a,s,c,u,l,h,d,f,p,m,M,g){const v=g??new t(16);return v[0]=e,v[1]=n,v[2]=r,v[3]=i,v[4]=o,v[5]=a,v[6]=s,v[7]=c,v[8]=u,v[9]=l,v[10]=h,v[11]=d,v[12]=f,v[13]=p,v[14]=m,v[15]=M,v},fromMat3:function(e,n){const r=n??new t(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=0,r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=0,r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},fromQuat:function(e,n){const r=n??new t(16),i=e[0],o=e[1],a=e[2],s=e[3],c=i+i,u=o+o,l=a+a,h=i*c,d=o*c,f=o*u,p=a*c,m=a*u,M=a*l,g=s*c,v=s*u,x=s*l;return r[0]=1-f-M,r[1]=d+x,r[2]=p-v,r[3]=0,r[4]=d-x,r[5]=1-h-M,r[6]=m+g,r[7]=0,r[8]=p+v,r[9]=m-g,r[10]=1-h-f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},negate:function(e,n){const r=n??new t(16);return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r[4]=-e[4],r[5]=-e[5],r[6]=-e[6],r[7]=-e[7],r[8]=-e[8],r[9]=-e[9],r[10]=-e[10],r[11]=-e[11],r[12]=-e[12],r[13]=-e[13],r[14]=-e[14],r[15]=-e[15],r},copy:n,clone:r,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a&&Math.abs(t[2]-e[2])<a&&Math.abs(t[3]-e[3])<a&&Math.abs(t[4]-e[4])<a&&Math.abs(t[5]-e[5])<a&&Math.abs(t[6]-e[6])<a&&Math.abs(t[7]-e[7])<a&&Math.abs(t[8]-e[8])<a&&Math.abs(t[9]-e[9])<a&&Math.abs(t[10]-e[10])<a&&Math.abs(t[11]-e[11])<a&&Math.abs(t[12]-e[12])<a&&Math.abs(t[13]-e[13])<a&&Math.abs(t[14]-e[14])<a&&Math.abs(t[15]-e[15])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},identity:i,transpose:function(e,n){const r=n??new t(16);if(r===e){let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,r}const i=e[0],o=e[1],a=e[2],s=e[3],c=e[4],u=e[5],l=e[6],h=e[7],d=e[8],f=e[9],p=e[10],m=e[11],M=e[12],g=e[13],v=e[14],x=e[15];return r[0]=i,r[1]=c,r[2]=d,r[3]=M,r[4]=o,r[5]=u,r[6]=f,r[7]=g,r[8]=a,r[9]=l,r[10]=p,r[11]=v,r[12]=s,r[13]=h,r[14]=m,r[15]=x,r},inverse:o,determinant:function(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],c=t[7],u=t[8],l=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],M=t[15],g=h*M,v=m*d,x=s*M,w=m*c,y=s*d,b=h*c,B=r*M,R=m*i,P=r*d,k=h*i,S=r*c,T=s*i;return e*(g*a+w*l+y*p-(v*a+x*l+b*p))+o*(v*n+B*l+k*p-(g*n+R*l+P*p))+u*(x*n+R*a+S*p-(w*n+B*a+T*p))+f*(b*n+P*a+T*l-(y*n+k*a+S*l))},invert:s,multiply:c,mul:u,setTranslation:function(t,e,n){const r=n??i();return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11]),r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},getTranslation:function(t,n){const r=n??e.create();return r[0]=t[12],r[1]=t[13],r[2]=t[14],r},getAxis:function(t,n,r){const i=r??e.create(),o=4*n;return i[0]=t[o+0],i[1]=t[o+1],i[2]=t[o+2],i},setAxis:function(t,e,r,i){const o=i===t?i:n(t,i),a=4*r;return o[a+0]=e[0],o[a+1]=e[1],o[a+2]=e[2],o},getScaling:function(t,n){const r=n??e.create(),i=t[0],o=t[1],a=t[2],s=t[4],c=t[5],u=t[6],l=t[8],h=t[9],d=t[10];return r[0]=Math.sqrt(i*i+o*o+a*a),r[1]=Math.sqrt(s*s+c*c+u*u),r[2]=Math.sqrt(l*l+h*h+d*d),r},perspective:function(e,n,r,i,o){const a=o??new t(16),s=Math.tan(.5*Math.PI-.5*e);if(a[0]=s/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,Number.isFinite(i)){const t=1/(r-i);a[10]=i*t,a[14]=i*r*t}else a[10]=-1,a[14]=-r;return a},perspectiveReverseZ:function(e,n,r,i=1/0,o){const a=o??new t(16),s=1/Math.tan(.5*e);if(a[0]=s/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,i===1/0)a[10]=0,a[14]=r;else{const t=1/(i-r);a[10]=r*t,a[14]=i*r*t}return a},ortho:function(e,n,r,i,o,a,s){const c=s??new t(16);return c[0]=2/(n-e),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2/(i-r),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1/(o-a),c[11]=0,c[12]=(n+e)/(e-n),c[13]=(i+r)/(r-i),c[14]=o/(o-a),c[15]=1,c},frustum:function(e,n,r,i,o,a,s){const c=s??new t(16),u=n-e,l=i-r,h=o-a;return c[0]=2*o/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2*o/l,c[6]=0,c[7]=0,c[8]=(e+n)/u,c[9]=(i+r)/l,c[10]=a/h,c[11]=-1,c[12]=0,c[13]=0,c[14]=o*a/h,c[15]=0,c},frustumReverseZ:function(e,n,r,i,o,a=1/0,s){const c=s??new t(16),u=n-e,l=i-r;if(c[0]=2*o/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=2*o/l,c[6]=0,c[7]=0,c[8]=(e+n)/u,c[9]=(i+r)/l,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,a===1/0)c[10]=0,c[14]=o;else{const t=1/(a-o);c[10]=o*t,c[14]=a*o*t}return c},aim:function(n,r,i,o){const a=o??new t(16);return e.normalize(e.subtract(r,n,f),f),e.normalize(e.cross(i,f,h),h),e.normalize(e.cross(f,h,d),d),a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=0,a[4]=d[0],a[5]=d[1],a[6]=d[2],a[7]=0,a[8]=f[0],a[9]=f[1],a[10]=f[2],a[11]=0,a[12]=n[0],a[13]=n[1],a[14]=n[2],a[15]=1,a},cameraAim:function(n,r,i,o){const a=o??new t(16);return e.normalize(e.subtract(n,r,f),f),e.normalize(e.cross(i,f,h),h),e.normalize(e.cross(f,h,d),d),a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=0,a[4]=d[0],a[5]=d[1],a[6]=d[2],a[7]=0,a[8]=f[0],a[9]=f[1],a[10]=f[2],a[11]=0,a[12]=n[0],a[13]=n[1],a[14]=n[2],a[15]=1,a},lookAt:function(n,r,i,o){const a=o??new t(16);return e.normalize(e.subtract(n,r,f),f),e.normalize(e.cross(i,f,h),h),e.normalize(e.cross(f,h,d),d),a[0]=h[0],a[1]=d[0],a[2]=f[0],a[3]=0,a[4]=h[1],a[5]=d[1],a[6]=f[1],a[7]=0,a[8]=h[2],a[9]=d[2],a[10]=f[2],a[11]=0,a[12]=-(h[0]*n[0]+h[1]*n[1]+h[2]*n[2]),a[13]=-(d[0]*n[0]+d[1]*n[1]+d[2]*n[2]),a[14]=-(f[0]*n[0]+f[1]*n[1]+f[2]*n[2]),a[15]=1,a},translation:function(e,n){const r=n??new t(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},translate:function(e,n,r){const i=r??new t(16),o=n[0],a=n[1],s=n[2],c=e[0],u=e[1],l=e[2],h=e[3],d=e[4],f=e[5],p=e[6],m=e[7],M=e[8],g=e[9],v=e[10],x=e[11],w=e[12],y=e[13],b=e[14],B=e[15];return e!==i&&(i[0]=c,i[1]=u,i[2]=l,i[3]=h,i[4]=d,i[5]=f,i[6]=p,i[7]=m,i[8]=M,i[9]=g,i[10]=v,i[11]=x),i[12]=c*o+d*a+M*s+w,i[13]=u*o+f*a+g*s+y,i[14]=l*o+p*a+v*s+b,i[15]=h*o+m*a+x*s+B,i},rotationX:function(e,n){const r=n??new t(16),i=Math.cos(e),o=Math.sin(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=o,r[7]=0,r[8]=0,r[9]=-o,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotateX:function(e,n,r){const i=r??new t(16),o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l=e[9],h=e[10],d=e[11],f=Math.cos(n),p=Math.sin(n);return i[4]=f*o+p*u,i[5]=f*a+p*l,i[6]=f*s+p*h,i[7]=f*c+p*d,i[8]=f*u-p*o,i[9]=f*l-p*a,i[10]=f*h-p*s,i[11]=f*d-p*c,e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i},rotationY:function(e,n){const r=n??new t(16),i=Math.cos(e),o=Math.sin(e);return r[0]=i,r[1]=0,r[2]=-o,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=o,r[9]=0,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotateY:function(e,n,r){const i=r??new t(16),o=e[0],a=e[1],s=e[2],c=e[3],u=e[8],l=e[9],h=e[10],d=e[11],f=Math.cos(n),p=Math.sin(n);return i[0]=f*o-p*u,i[1]=f*a-p*l,i[2]=f*s-p*h,i[3]=f*c-p*d,i[8]=f*u+p*o,i[9]=f*l+p*a,i[10]=f*h+p*s,i[11]=f*d+p*c,e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i},rotationZ:function(e,n){const r=n??new t(16),i=Math.cos(e),o=Math.sin(e);return r[0]=i,r[1]=o,r[2]=0,r[3]=0,r[4]=-o,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotateZ:function(e,n,r){const i=r??new t(16),o=e[0],a=e[1],s=e[2],c=e[3],u=e[4],l=e[5],h=e[6],d=e[7],f=Math.cos(n),p=Math.sin(n);return i[0]=f*o+p*u,i[1]=f*a+p*l,i[2]=f*s+p*h,i[3]=f*c+p*d,i[4]=f*u-p*o,i[5]=f*l-p*a,i[6]=f*h-p*s,i[7]=f*d-p*c,e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i},axisRotation:p,rotation:p,axisRotate:m,rotate:m,scaling:function(e,n){const r=n??new t(16);return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},scale:function(e,n,r){const i=r??new t(16),o=n[0],a=n[1],s=n[2];return i[0]=o*e[0],i[1]=o*e[1],i[2]=o*e[2],i[3]=o*e[3],i[4]=a*e[4],i[5]=a*e[5],i[6]=a*e[6],i[7]=a*e[7],i[8]=s*e[8],i[9]=s*e[9],i[10]=s*e[10],i[11]=s*e[11],e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i},uniformScaling:function(e,n){const r=n??new t(16);return r[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},uniformScale:function(e,n,r){const i=r??new t(16);return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=n*e[3],i[4]=n*e[4],i[5]=n*e[5],i[6]=n*e[6],i[7]=n*e[7],i[8]=n*e[8],i[9]=n*e[9],i[10]=n*e[10],i[11]=n*e[11],e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i}}}(t),f.set(t,e)),e}const m=new Map;function M(t){let e=m.get(t);return e||(e=function(t){const e=l(t);function n(e,n,r,i){const o=new t(4);return void 0!==e&&(o[0]=e,void 0!==n&&(o[1]=n,void 0!==r&&(o[2]=r,void 0!==i&&(o[3]=i)))),o}const r=n;function i(e,n,r){const i=r??new t(4),o=.5*n,a=Math.sin(o);return i[0]=a*e[0],i[1]=a*e[1],i[2]=a*e[2],i[3]=Math.cos(o),i}function o(e,n,r){const i=r??new t(4),o=e[0],a=e[1],s=e[2],c=e[3],u=n[0],l=n[1],h=n[2],d=n[3];return i[0]=o*d+c*u+a*h-s*l,i[1]=a*d+c*l+s*u-o*h,i[2]=s*d+c*h+o*l-a*u,i[3]=c*d-o*u-a*l-s*h,i}const s=o;function c(e,n,r,i){const o=i??new t(4),s=e[0],c=e[1],u=e[2],l=e[3];let h,d,f=n[0],p=n[1],m=n[2],M=n[3],g=s*f+c*p+u*m+l*M;if(g<0&&(g=-g,f=-f,p=-p,m=-m,M=-M),1-g>a){const t=Math.acos(g),e=Math.sin(t);h=Math.sin((1-r)*t)/e,d=Math.sin(r*t)/e}else h=1-r,d=r;return o[0]=h*s+d*f,o[1]=h*c+d*p,o[2]=h*u+d*m,o[3]=h*l+d*M,o}function u(e,n){const r=n??new t(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}const h=u;function d(e,n,r){const i=r??new t(4);return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i[3]=e[3]-n[3],i}const f=d;function p(e,n,r){const i=r??new t(4);return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i}const m=p;function M(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function g(t){const e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}const v=g;function x(t){const e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}const w=x;function y(e,n){const r=n??new t(4),i=e[0],o=e[1],a=e[2],s=e[3],c=Math.sqrt(i*i+o*o+a*a+s*s);return c>1e-5?(r[0]=i/c,r[1]=o/c,r[2]=a/c,r[3]=s/c):(r[0]=0,r[1]=0,r[2]=0,r[3]=1),r}const b=e.create(),B=e.create(),R=e.create(),P=new t(4),k=new t(4);return{create:n,fromValues:r,set:function(e,n,r,i,o){const a=o??new t(4);return a[0]=e,a[1]=n,a[2]=r,a[3]=i,a},fromAxisAngle:i,toAxisAngle:function(t,n){const r=n??e.create(3),i=2*Math.acos(t[3]),o=Math.sin(.5*i);return o>a?(r[0]=t[0]/o,r[1]=t[1]/o,r[2]=t[2]/o):(r[0]=1,r[1]=0,r[2]=0),{angle:i,axis:r}},angle:function(t,e){const n=M(t,e);return Math.acos(2*n*n-1)},multiply:o,mul:s,rotateX:function(e,n,r){const i=r??new t(4),o=.5*n,a=e[0],s=e[1],c=e[2],u=e[3],l=Math.sin(o),h=Math.cos(o);return i[0]=a*h+u*l,i[1]=s*h+c*l,i[2]=c*h-s*l,i[3]=u*h-a*l,i},rotateY:function(e,n,r){const i=r??new t(4),o=.5*n,a=e[0],s=e[1],c=e[2],u=e[3],l=Math.sin(o),h=Math.cos(o);return i[0]=a*h-c*l,i[1]=s*h+u*l,i[2]=c*h+a*l,i[3]=u*h-s*l,i},rotateZ:function(e,n,r){const i=r??new t(4),o=.5*n,a=e[0],s=e[1],c=e[2],u=e[3],l=Math.sin(o),h=Math.cos(o);return i[0]=a*h+s*l,i[1]=s*h-a*l,i[2]=c*h+u*l,i[3]=u*h-c*l,i},slerp:c,inverse:function(e,n){const r=n??new t(4),i=e[0],o=e[1],a=e[2],s=e[3],c=i*i+o*o+a*a+s*s,u=c?1/c:0;return r[0]=-i*u,r[1]=-o*u,r[2]=-a*u,r[3]=s*u,r},conjugate:function(e,n){const r=n??new t(4);return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},fromMat:function(e,n){const r=n??new t(4),i=e[0]+e[5]+e[10];if(i>0){const t=Math.sqrt(i+1);r[3]=.5*t;const n=.5/t;r[0]=(e[6]-e[9])*n,r[1]=(e[8]-e[2])*n,r[2]=(e[1]-e[4])*n}else{let t=0;e[5]>e[0]&&(t=1),e[10]>e[4*t+t]&&(t=2);const n=(t+1)%3,i=(t+2)%3,o=Math.sqrt(e[4*t+t]-e[4*n+n]-e[4*i+i]+1);r[t]=.5*o;const a=.5/o;r[3]=(e[4*n+i]-e[4*i+n])*a,r[n]=(e[4*n+t]+e[4*t+n])*a,r[i]=(e[4*i+t]+e[4*t+i])*a}return r},fromEuler:function(e,n,r,i,o){const a=o??new t(4),s=.5*e,c=.5*n,u=.5*r,l=Math.sin(s),h=Math.cos(s),d=Math.sin(c),f=Math.cos(c),p=Math.sin(u),m=Math.cos(u);switch(i){case"xyz":a[0]=l*f*m+h*d*p,a[1]=h*d*m-l*f*p,a[2]=h*f*p+l*d*m,a[3]=h*f*m-l*d*p;break;case"xzy":a[0]=l*f*m-h*d*p,a[1]=h*d*m-l*f*p,a[2]=h*f*p+l*d*m,a[3]=h*f*m+l*d*p;break;case"yxz":a[0]=l*f*m+h*d*p,a[1]=h*d*m-l*f*p,a[2]=h*f*p-l*d*m,a[3]=h*f*m+l*d*p;break;case"yzx":a[0]=l*f*m+h*d*p,a[1]=h*d*m+l*f*p,a[2]=h*f*p-l*d*m,a[3]=h*f*m-l*d*p;break;case"zxy":a[0]=l*f*m-h*d*p,a[1]=h*d*m+l*f*p,a[2]=h*f*p+l*d*m,a[3]=h*f*m-l*d*p;break;case"zyx":a[0]=l*f*m-h*d*p,a[1]=h*d*m+l*f*p,a[2]=h*f*p-l*d*m,a[3]=h*f*m+l*d*p;break;default:throw new Error(`Unknown rotation order: ${i}`)}return a},copy:u,clone:h,add:function(e,n,r){const i=r??new t(4);return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i[3]=e[3]+n[3],i},subtract:d,sub:f,mulScalar:p,scale:m,divScalar:function(e,n,r){const i=r??new t(4);return i[0]=e[0]/n,i[1]=e[1]/n,i[2]=e[2]/n,i[3]=e[3]/n,i},dot:M,lerp:function(e,n,r,i){const o=i??new t(4);return o[0]=e[0]+r*(n[0]-e[0]),o[1]=e[1]+r*(n[1]-e[1]),o[2]=e[2]+r*(n[2]-e[2]),o[3]=e[3]+r*(n[3]-e[3]),o},length:g,len:v,lengthSq:x,lenSq:w,normalize:y,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a&&Math.abs(t[2]-e[2])<a&&Math.abs(t[3]-e[3])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},identity:function(e){const n=e??new t(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n},rotationTo:function(n,r,o){const a=o??new t(4),s=e.dot(n,r);return s<-.999999?(e.cross(B,n,b),e.len(b)<1e-6&&e.cross(R,n,b),e.normalize(b,b),i(b,Math.PI,a),a):s>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(e.cross(n,r,b),a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=1+s,y(a,a))},sqlerp:function(e,n,r,i,o,a){const s=a??new t(4);return c(e,i,o,P),c(n,r,o,k),c(P,k,2*o*(1-o),s),s}}}(t),m.set(t,e)),e}const g=new Map;function v(t){let e=g.get(t);return e||(e=function(t){function e(e,n,r,i){const o=new t(4);return void 0!==e&&(o[0]=e,void 0!==n&&(o[1]=n,void 0!==r&&(o[2]=r,void 0!==i&&(o[3]=i)))),o}function n(e,n,r){const i=r??new t(4);return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i[3]=e[3]-n[3],i}function r(e,n,r,i){const o=i??new t(4);return o[0]=e[0]+r*(n[0]-e[0]),o[1]=e[1]+r*(n[1]-e[1]),o[2]=e[2]+r*(n[2]-e[2]),o[3]=e[3]+r*(n[3]-e[3]),o}function i(e,n,r){const i=r??new t(4);return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i}function o(e,n){const r=n??new t(4);return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r[3]=1/e[3],r}function s(t){const e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function c(t){const e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function u(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function l(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function h(e,n){const r=n??new t(4),i=e[0],o=e[1],a=e[2],s=e[3],c=Math.sqrt(i*i+o*o+a*a+s*s);return c>1e-5?(r[0]=i/c,r[1]=o/c,r[2]=a/c,r[3]=s/c):(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function d(e,n){const r=n??new t(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function f(e,n,r){const i=r??new t(4);return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i[3]=e[3]*n[3],i}function p(e,n,r){const i=r??new t(4);return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i[2]=e[2]/n[2],i[3]=e[3]/n[3],i}function m(e,n,r){const o=r??new t(4);return h(e,o),i(o,n,o)}return{create:e,fromValues:e,set:function(e,n,r,i,o){const a=o??new t(4);return a[0]=e,a[1]=n,a[2]=r,a[3]=i,a},ceil:function(e,n){const r=n??new t(4);return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r[3]=Math.ceil(e[3]),r},floor:function(e,n){const r=n??new t(4);return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r[3]=Math.floor(e[3]),r},round:function(e,n){const r=n??new t(4);return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r[3]=Math.round(e[3]),r},clamp:function(e,n=0,r=1,i){const o=i??new t(4);return o[0]=Math.min(r,Math.max(n,e[0])),o[1]=Math.min(r,Math.max(n,e[1])),o[2]=Math.min(r,Math.max(n,e[2])),o[3]=Math.min(r,Math.max(n,e[3])),o},add:function(e,n,r){const i=r??new t(4);return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i[3]=e[3]+n[3],i},addScaled:function(e,n,r,i){const o=i??new t(4);return o[0]=e[0]+n[0]*r,o[1]=e[1]+n[1]*r,o[2]=e[2]+n[2]*r,o[3]=e[3]+n[3]*r,o},subtract:n,sub:n,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<a&&Math.abs(t[1]-e[1])<a&&Math.abs(t[2]-e[2])<a&&Math.abs(t[3]-e[3])<a},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},lerp:r,lerpV:function(e,n,r,i){const o=i??new t(4);return o[0]=e[0]+r[0]*(n[0]-e[0]),o[1]=e[1]+r[1]*(n[1]-e[1]),o[2]=e[2]+r[2]*(n[2]-e[2]),o[3]=e[3]+r[3]*(n[3]-e[3]),o},max:function(e,n,r){const i=r??new t(4);return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i[3]=Math.max(e[3],n[3]),i},min:function(e,n,r){const i=r??new t(4);return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i[3]=Math.min(e[3],n[3]),i},mulScalar:i,scale:i,divScalar:function(e,n,r){const i=r??new t(4);return i[0]=e[0]/n,i[1]=e[1]/n,i[2]=e[2]/n,i[3]=e[3]/n,i},inverse:o,invert:o,dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},length:s,len:s,lengthSq:c,lenSq:c,distance:u,dist:u,distanceSq:l,distSq:l,normalize:h,negate:function(e,n){const r=n??new t(4);return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=-e[3],r},copy:d,clone:d,multiply:f,mul:f,divide:p,div:p,zero:function(e){const n=e??new t(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n},transformMat4:function(e,n,r){const i=r??new t(4),o=e[0],a=e[1],s=e[2],c=e[3];return i[0]=n[0]*o+n[4]*a+n[8]*s+n[12]*c,i[1]=n[1]*o+n[5]*a+n[9]*s+n[13]*c,i[2]=n[2]*o+n[6]*a+n[10]*s+n[14]*c,i[3]=n[3]*o+n[7]*a+n[11]*s+n[15]*c,i},setLength:m,truncate:function(e,n,r){const i=r??new t(4);return s(e)>n?m(e,n,i):d(e,i)},midpoint:function(e,n,i){return r(e,n,.5,i??new t(4))}}}(t),g.set(t,e)),e}function x(t,e,n,r,i,o){return{mat3:d(t),mat4:p(e),quat:M(n),vec2:c(r),vec3:l(i),vec4:v(o)}}const{mat3:w,mat4:y,quat:b,vec2:B,vec3:R,vec4:P}=x(Float32Array,Float32Array,Float32Array,Float32Array,Float32Array,Float32Array),{mat3:k,mat4:S,quat:T,vec2:I,vec3:A,vec4:D}=x(Float64Array,Float64Array,Float64Array,Float64Array,Float64Array,Float64Array),{mat3:E,mat4:F,quat:q,vec2:z,vec3:V,vec4:G}=x(r,Array,Array,Array,Array,Array)}},o={};function a(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return i[t](n,n.exports,a),n.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},a.a=(i,o,a)=>{var s;a&&((s=[]).d=-1);var c,u,l,h=new Set,d=i.exports,f=new Promise(((t,e)=>{l=e,u=t}));f[e]=d,f[t]=t=>(s&&t(s),h.forEach(t),f.catch((t=>{}))),i.exports=f,o((i=>{var o;c=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[t])return i;if(i.then){var o=[];o.d=0,i.then((t=>{a[e]=t,r(o)}),(t=>{a[n]=t,r(o)}));var a={};return a[t]=t=>t(o),a}}var s={};return s[t]=t=>{},s[e]=i,s})))(i);var a=()=>c.map((t=>{if(t[n])throw t[n];return t[e]})),u=new Promise((e=>{(o=()=>e(a)).r=0;var n=t=>t!==s&&!h.has(t)&&(h.add(t),t&&!t.d&&(o.r++,t.push(o)));c.map((e=>e[t](n)))}));return o.r?u:a()}),(t=>(t?l(f[n]=t):u(d),r(s)))),s&&s.d<0&&(s.d=0)},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a(88)})();
//# sourceMappingURL=main.bundle.js.map